{"version":3,"file":"utils.js","names":["Utils","tableName","schema","prefix","quote","table","escapedSchema","escape","escapeIdentifier","identifier","length","needsQuotes","test","replace","escaped","RegExp","flattenElements","elements","recurseRepeatables","assignParent","parent","flat","element","push","recurse","type","children","Array","prototype","apply"],"sources":["../src/utils.js"],"sourcesContent":["export default class Utils {\n  static tableName(schema, prefix, quote, table) {\n    return Utils.escapedSchema(schema, quote) + Utils.escape((prefix || '') + table, quote);\n  }\n\n  static escapeIdentifier(identifier) {\n    if (identifier == null || identifier.length === 0) {\n      return '';\n    }\n\n    const needsQuotes = /[^_A-Z0-9]/i.test(identifier) ||\n                        /^[0-9]/.test(identifier);\n\n    if (needsQuotes) {\n      return '\"' + (identifier.replace(/\"/g, '\"\"')) + '\"';\n    }\n\n    return identifier;\n  }\n\n  static escapedSchema(schema, quote) {\n    if (schema == null || schema.length === 0) {\n      return '';\n    }\n\n    return Utils.escape(schema, quote) + '.';\n  }\n\n  static escape(identifier, quote) {\n    if (identifier == null || identifier.length === 0) {\n      return '';\n    }\n\n    quote = quote || '\"';\n\n    const escaped = identifier.replace(new RegExp(quote, 'g'), quote + quote);\n\n    return quote + escaped + quote;\n  }\n\n  static flattenElements(elements, recurseRepeatables, assignParent, parent) {\n    if (recurseRepeatables == null) {\n      recurseRepeatables = true;\n    }\n\n    if (assignParent == null) {\n      assignParent = false;\n    }\n\n    const flat = [];\n\n    for (const element of elements) {\n      if (assignParent) {\n        element.parent = parent;\n      }\n\n      flat.push(element);\n\n      let recurse = true;\n\n      if (!recurseRepeatables && element.type === 'Repeatable') {\n        recurse = false;\n      }\n\n      if (recurse && element.elements) {\n        const children = Utils.flattenElements(element.elements, recurseRepeatables, assignParent, element);\n        Array.prototype.push.apply(flat, children);\n      }\n    }\n\n    return flat;\n  }\n}\n"],"mappings":";;;;;;;;;;;;;IAAqBA,K;;;QACZC,S,GAAP,mBAAiBC,MAAjB,EAAyBC,MAAzB,EAAiCC,KAAjC,EAAwCC,KAAxC,EAA+C;IAC7C,OAAOL,KAAK,CAACM,aAAN,CAAoBJ,MAApB,EAA4BE,KAA5B,IAAqCJ,KAAK,CAACO,MAAN,CAAa,CAACJ,MAAM,IAAI,EAAX,IAAiBE,KAA9B,EAAqCD,KAArC,CAA5C;EACD,C;;QAEMI,gB,GAAP,0BAAwBC,UAAxB,EAAoC;IAClC,IAAIA,UAAU,IAAI,IAAd,IAAsBA,UAAU,CAACC,MAAX,KAAsB,CAAhD,EAAmD;MACjD,OAAO,EAAP;IACD;;IAED,IAAMC,WAAW,GAAG,cAAcC,IAAd,CAAmBH,UAAnB,KACA,SAASG,IAAT,CAAcH,UAAd,CADpB;;IAGA,IAAIE,WAAJ,EAAiB;MACf,OAAO,MAAOF,UAAU,CAACI,OAAX,CAAmB,IAAnB,EAAyB,IAAzB,CAAP,GAAyC,GAAhD;IACD;;IAED,OAAOJ,UAAP;EACD,C;;QAEMH,a,GAAP,uBAAqBJ,MAArB,EAA6BE,KAA7B,EAAoC;IAClC,IAAIF,MAAM,IAAI,IAAV,IAAkBA,MAAM,CAACQ,MAAP,KAAkB,CAAxC,EAA2C;MACzC,OAAO,EAAP;IACD;;IAED,OAAOV,KAAK,CAACO,MAAN,CAAaL,MAAb,EAAqBE,KAArB,IAA8B,GAArC;EACD,C;;QAEMG,M,GAAP,gBAAcE,UAAd,EAA0BL,KAA1B,EAAiC;IAC/B,IAAIK,UAAU,IAAI,IAAd,IAAsBA,UAAU,CAACC,MAAX,KAAsB,CAAhD,EAAmD;MACjD,OAAO,EAAP;IACD;;IAEDN,KAAK,GAAGA,KAAK,IAAI,GAAjB;IAEA,IAAMU,OAAO,GAAGL,UAAU,CAACI,OAAX,CAAmB,IAAIE,MAAJ,CAAWX,KAAX,EAAkB,GAAlB,CAAnB,EAA2CA,KAAK,GAAGA,KAAnD,CAAhB;IAEA,OAAOA,KAAK,GAAGU,OAAR,GAAkBV,KAAzB;EACD,C;;QAEMY,e,GAAP,yBAAuBC,QAAvB,EAAiCC,kBAAjC,EAAqDC,YAArD,EAAmEC,MAAnE,EAA2E;IACzE,IAAIF,kBAAkB,IAAI,IAA1B,EAAgC;MAC9BA,kBAAkB,GAAG,IAArB;IACD;;IAED,IAAIC,YAAY,IAAI,IAApB,EAA0B;MACxBA,YAAY,GAAG,KAAf;IACD;;IAED,IAAME,IAAI,GAAG,EAAb;;IAEA,qDAAsBJ,QAAtB,wCAAgC;MAAA,IAArBK,OAAqB;;MAC9B,IAAIH,YAAJ,EAAkB;QAChBG,OAAO,CAACF,MAAR,GAAiBA,MAAjB;MACD;;MAEDC,IAAI,CAACE,IAAL,CAAUD,OAAV;MAEA,IAAIE,OAAO,GAAG,IAAd;;MAEA,IAAI,CAACN,kBAAD,IAAuBI,OAAO,CAACG,IAAR,KAAiB,YAA5C,EAA0D;QACxDD,OAAO,GAAG,KAAV;MACD;;MAED,IAAIA,OAAO,IAAIF,OAAO,CAACL,QAAvB,EAAiC;QAC/B,IAAMS,QAAQ,GAAG1B,KAAK,CAACgB,eAAN,CAAsBM,OAAO,CAACL,QAA9B,EAAwCC,kBAAxC,EAA4DC,YAA5D,EAA0EG,OAA1E,CAAjB;QACAK,KAAK,CAACC,SAAN,CAAgBL,IAAhB,CAAqBM,KAArB,CAA2BR,IAA3B,EAAiCK,QAAjC;MACD;IACF;;IAED,OAAOL,IAAP;EACD,C"}