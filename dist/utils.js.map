{"version":3,"sources":["../src/utils.js"],"names":["Utils","tableName","schema","prefix","quote","table","escapedSchema","escape","escapeIdentifier","identifier","length","needsQuotes","test","replace","escaped","RegExp","flattenElements","elements","recurseRepeatables","assignParent","parent","flat","element","push","recurse","type","children","Array","prototype","apply"],"mappings":";;;;;;;;;;;;;IAAqBA,K;;;QACZC,S,GAAP,mBAAiBC,MAAjB,EAAyBC,MAAzB,EAAiCC,KAAjC,EAAwCC,KAAxC,EAA+C;AAC7C,WAAOL,KAAK,CAACM,aAAN,CAAoBJ,MAApB,EAA4BE,KAA5B,IAAqCJ,KAAK,CAACO,MAAN,CAAa,CAACJ,MAAM,IAAI,EAAX,IAAiBE,KAA9B,EAAqCD,KAArC,CAA5C;AACD,G;;QAEMI,gB,GAAP,0BAAwBC,UAAxB,EAAoC;AAClC,QAAIA,UAAU,IAAI,IAAd,IAAsBA,UAAU,CAACC,MAAX,KAAsB,CAAhD,EAAmD;AACjD,aAAO,EAAP;AACD;;AAED,QAAMC,WAAW,GAAG,cAAcC,IAAd,CAAmBH,UAAnB,KACA,SAASG,IAAT,CAAcH,UAAd,CADpB;;AAGA,QAAIE,WAAJ,EAAiB;AACf,aAAO,MAAOF,UAAU,CAACI,OAAX,CAAmB,IAAnB,EAAyB,IAAzB,CAAP,GAAyC,GAAhD;AACD;;AAED,WAAOJ,UAAP;AACD,G;;QAEMH,a,GAAP,uBAAqBJ,MAArB,EAA6BE,KAA7B,EAAoC;AAClC,QAAIF,MAAM,IAAI,IAAV,IAAkBA,MAAM,CAACQ,MAAP,KAAkB,CAAxC,EAA2C;AACzC,aAAO,EAAP;AACD;;AAED,WAAOV,KAAK,CAACO,MAAN,CAAaL,MAAb,EAAqBE,KAArB,IAA8B,GAArC;AACD,G;;QAEMG,M,GAAP,gBAAcE,UAAd,EAA0BL,KAA1B,EAAiC;AAC/B,QAAIK,UAAU,IAAI,IAAd,IAAsBA,UAAU,CAACC,MAAX,KAAsB,CAAhD,EAAmD;AACjD,aAAO,EAAP;AACD;;AAEDN,IAAAA,KAAK,GAAGA,KAAK,IAAI,GAAjB;AAEA,QAAMU,OAAO,GAAGL,UAAU,CAACI,OAAX,CAAmB,IAAIE,MAAJ,CAAWX,KAAX,EAAkB,GAAlB,CAAnB,EAA2CA,KAAK,GAAGA,KAAnD,CAAhB;AAEA,WAAOA,KAAK,GAAGU,OAAR,GAAkBV,KAAzB;AACD,G;;QAEMY,e,GAAP,yBAAuBC,QAAvB,EAAiCC,kBAAjC,EAAqDC,YAArD,EAAmEC,MAAnE,EAA2E;AACzE,QAAIF,kBAAkB,IAAI,IAA1B,EAAgC;AAC9BA,MAAAA,kBAAkB,GAAG,IAArB;AACD;;AAED,QAAIC,YAAY,IAAI,IAApB,EAA0B;AACxBA,MAAAA,YAAY,GAAG,KAAf;AACD;;AAED,QAAME,IAAI,GAAG,EAAb;;AAEA,yDAAsBJ,QAAtB,wCAAgC;AAAA,UAArBK,OAAqB;;AAC9B,UAAIH,YAAJ,EAAkB;AAChBG,QAAAA,OAAO,CAACF,MAAR,GAAiBA,MAAjB;AACD;;AAEDC,MAAAA,IAAI,CAACE,IAAL,CAAUD,OAAV;AAEA,UAAIE,OAAO,GAAG,IAAd;;AAEA,UAAI,CAACN,kBAAD,IAAuBI,OAAO,CAACG,IAAR,KAAiB,YAA5C,EAA0D;AACxDD,QAAAA,OAAO,GAAG,KAAV;AACD;;AAED,UAAIA,OAAO,IAAIF,OAAO,CAACL,QAAvB,EAAiC;AAC/B,YAAMS,QAAQ,GAAG1B,KAAK,CAACgB,eAAN,CAAsBM,OAAO,CAACL,QAA9B,EAAwCC,kBAAxC,EAA4DC,YAA5D,EAA0EG,OAA1E,CAAjB;AACAK,QAAAA,KAAK,CAACC,SAAN,CAAgBL,IAAhB,CAAqBM,KAArB,CAA2BR,IAA3B,EAAiCK,QAAjC;AACD;AACF;;AAED,WAAOL,IAAP;AACD,G","sourcesContent":["export default class Utils {\n  static tableName(schema, prefix, quote, table) {\n    return Utils.escapedSchema(schema, quote) + Utils.escape((prefix || '') + table, quote);\n  }\n\n  static escapeIdentifier(identifier) {\n    if (identifier == null || identifier.length === 0) {\n      return '';\n    }\n\n    const needsQuotes = /[^_A-Z0-9]/i.test(identifier) ||\n                        /^[0-9]/.test(identifier);\n\n    if (needsQuotes) {\n      return '\"' + (identifier.replace(/\"/g, '\"\"')) + '\"';\n    }\n\n    return identifier;\n  }\n\n  static escapedSchema(schema, quote) {\n    if (schema == null || schema.length === 0) {\n      return '';\n    }\n\n    return Utils.escape(schema, quote) + '.';\n  }\n\n  static escape(identifier, quote) {\n    if (identifier == null || identifier.length === 0) {\n      return '';\n    }\n\n    quote = quote || '\"';\n\n    const escaped = identifier.replace(new RegExp(quote, 'g'), quote + quote);\n\n    return quote + escaped + quote;\n  }\n\n  static flattenElements(elements, recurseRepeatables, assignParent, parent) {\n    if (recurseRepeatables == null) {\n      recurseRepeatables = true;\n    }\n\n    if (assignParent == null) {\n      assignParent = false;\n    }\n\n    const flat = [];\n\n    for (const element of elements) {\n      if (assignParent) {\n        element.parent = parent;\n      }\n\n      flat.push(element);\n\n      let recurse = true;\n\n      if (!recurseRepeatables && element.type === 'Repeatable') {\n        recurse = false;\n      }\n\n      if (recurse && element.elements) {\n        const children = Utils.flattenElements(element.elements, recurseRepeatables, assignParent, element);\n        Array.prototype.push.apply(flat, children);\n      }\n    }\n\n    return flat;\n  }\n}\n"],"file":"utils.js"}