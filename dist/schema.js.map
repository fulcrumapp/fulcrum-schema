{"version":3,"file":"schema.js","names":["Table","sqldiff","View","SIMPLE_TYPES","Schema","form","columns","options","prefix","elements","Utils","flattenElements","schemaElements","DataElements","find","buildSchema","calculatedFieldDateFormat","tables","views","formTable","buildFormTable","valuesTable","buildValuesTable","push","buildDataColumns","buildViews","buildIndexes","alias","part","escapePart","partName","escapeDataName","escapeSlashes","name","dataName","replace","table","format","row_id","type","form_id","id","systemFormTableColumns","column","formColumn","clone","system","maybeComplexType","addColumn","onAddFormTable","schema","systemValuesTableColumns","valueColumn","buildRepeatableTable","parentTable","element","key","parent","data_name","systemRepeatableTableColumns","attrs","onAddRepeatableTable","processElement","viewColumns","systemFormViewColumns","view","buildViewForTable","fullView","variant","columnNames","viewColumnName","projection","escapeIdentifier","raw","indexDefinitions","systemFormTableIndexes","systemRepeatableTableIndexes","systemValuesTableIndexes","index","indexDefinition","isComplex","method","skip","disableComplexTypes","addIndex","systemFormFullViewColumns","systemRepeatableFullViewColumns","systemRepeatableViewColumns","systemValuesViewColumns","suffix","launderViewColumnName","count","rawName","substring","toLowerCase","newName","toString","length","elementTable","numeric","addDoubleElement","addStringElement","multiple","addArrayElement","addMediaElement","addTimestampElement","addDateElement","addTimeElement","addRepeatableElement","addRecordLinkElement","display","style","addBooleanElement","console","log","addStringColumn","addElement","addIntegerElement","dataType","disableArrays","indexOf","includeMediaCaptions","includeMediaURLs","includeMediaViewURLs","value","clause","filter","PhotoField","VideoField","AudioField","AttachmentField","childTable","childElements","childElement"],"sources":["../src/schema.js"],"sourcesContent":["import { clone } from 'lodash';\nimport Utils from './utils';\nimport sqldiff from 'sqldiff';\nimport {format} from 'util';\nimport DataElements from './data-elements';\n\nconst {Table, View} = sqldiff;\n\nconst SIMPLE_TYPES = [\n  'pk',\n  'text',\n  'string',\n  'date',\n  'time',\n  'timestamp',\n  'double',\n  'integer',\n  'boolean'\n];\n\nexport default class Schema {\n  constructor(form, columns, options) {\n    this.prefix = 'f';\n    this.form = form;\n    this.columns = columns;\n    this.options = options || {};\n    this.elements = Utils.flattenElements(this.form.elements, false);\n    this.schemaElements = DataElements.find(this.elements);\n    this.buildSchema();\n\n    columns.calculatedFieldDateFormat = columns.calculatedFieldDateFormat === 'date' ? 'date' : 'double';\n  }\n\n  buildSchema() {\n    this.tables = [];\n    this.views = [];\n\n    this.formTable = this.buildFormTable();\n    this.valuesTable = this.buildValuesTable();\n\n    this.tables.push(this.formTable);\n    this.tables.push(this.valuesTable);\n\n    this.buildDataColumns();\n\n    this.buildViews();\n\n    this.buildIndexes();\n  }\n\n  alias(part, escapePart = true) {\n    if (part) {\n      const partName = escapePart ? this.escapeDataName(part) : part;\n\n      return this.escapeSlashes(this.form.name) + '/' + this.escapeSlashes(partName);\n    }\n    return this.escapeSlashes(this.form.name);\n  }\n\n  escapeDataName(dataName) {\n    // if a data name starts with an underscore, add an additional underscore to prevent\n    // collisions with future system-defined columns. e.g. `_symbol` becomes `__symbol`\n    // because at some point we might add a system column named `symbol` which needs the\n    // `_symbol` name.\n    if (dataName && dataName[0] === '_') {\n      return '_' + dataName;\n    }\n\n    return dataName || 'no_data_name';\n  }\n\n  escapeSlashes(name) {\n    return name.replace(/\\//g, '\\\\/');\n  }\n\n  buildFormTable() {\n    const table = new Table(format('form_%s', this.form.row_id),\n                            null,\n                            {type: 'form', alias: this.alias(), form_id: this.form.id});\n\n    for (const column of this.columns.systemFormTableColumns) {\n      const formColumn = clone(column);\n\n      formColumn.system = true;\n      formColumn.type = this.maybeComplexType(formColumn.type);\n\n      table.addColumn(formColumn);\n    }\n\n    if (this.options.onAddFormTable) {\n      this.options.onAddFormTable({table, form: this.form, schema: this});\n    }\n\n    return table;\n  }\n\n  buildValuesTable() {\n    const table = new Table(format('form_%s_values', this.form.row_id),\n                            null,\n                            {type: 'values', alias: this.alias('values'), form_id: this.form.id});\n\n    for (const column of this.columns.systemValuesTableColumns) {\n      const valueColumn = clone(column);\n\n      valueColumn.system = true;\n      valueColumn.type = this.maybeComplexType(valueColumn.type);\n\n      table.addColumn(valueColumn);\n    }\n\n    return table;\n  }\n\n  buildRepeatableTable(parentTable, element) {\n    const table = new Table(this.formTable.id + '_' + element.key,\n                            null,\n                            {type: 'repeatable', parent: parentTable, element: element, alias: this.alias(element.data_name), form_id: this.form.id});\n\n    for (const column of this.columns.systemRepeatableTableColumns) {\n      const attrs = clone(column);\n\n      attrs.id = element.key + '_' + column.name;\n      attrs.system = true;\n      attrs.type = this.maybeComplexType(attrs.type);\n\n      table.addColumn(attrs);\n    }\n\n    if (this.options.onAddRepeatableTable) {\n      this.options.onAddRepeatableTable({table, parentTable, element, form: this.form, schema: this});\n    }\n\n    return table;\n  }\n\n  buildDataColumns() {\n    for (const element of this.schemaElements) {\n      this.processElement(element, this.formTable);\n    }\n  }\n\n  buildViews() {\n    this.viewColumns = {};\n\n    if (!this.columns.systemFormViewColumns) {\n      return;\n    }\n\n    for (const table of this.tables) {\n      const view = new View(table.name + '_view', null, table);\n\n      this.buildViewForTable(table, view);\n\n      this.views.push(view);\n\n      if (table.type === 'form') {\n        const fullView = new View(table.name + '_view_full', null, table, {variant: 'full', alias: this.alias('_full', false)});\n\n        this.buildViewForTable(table, fullView);\n\n        this.views.push(fullView);\n      } else if (table.type === 'repeatable') {\n        const fullView = new View(table.name + '_view_full', null, table, {variant: 'full',\n                                                                           alias: this.alias(table.element.data_name) + '/_full'});\n\n        this.buildViewForTable(table, fullView);\n\n        this.views.push(fullView);\n      }\n    }\n  }\n\n  buildViewForTable(table, view) {\n    const columnNames = {};\n\n    for (const column of table.columns) {\n      const alias = this.viewColumnName(view, table, column);\n\n      if (alias == null) {\n        continue;\n      }\n\n      if (!columnNames[alias]) {\n        if (column.type === 'boolean') {\n          const projection = `${column.name} IS NOT NULL AND ${column.name} = 't' AS ${Utils.escapeIdentifier(alias)}`;\n          view.addColumn({column: column, alias: alias, raw: projection});\n        } else {\n          view.addColumn({column: column, alias: alias});\n        }\n\n        columnNames[alias] = column;\n      }\n    }\n  }\n\n  buildIndexes() {\n    for (const table of this.tables) {\n      let indexDefinitions = [];\n\n      if (table.type === 'form') {\n        indexDefinitions = this.columns.systemFormTableIndexes;\n      } else if (table.type === 'repeatable') {\n        indexDefinitions = this.columns.systemRepeatableTableIndexes;\n      } else if (table.type === 'values') {\n        indexDefinitions = this.columns.systemValuesTableIndexes;\n      }\n\n      for (const index of indexDefinitions) {\n        const indexDefinition = clone(index);\n\n        const isComplex = indexDefinition.method === 'gist' || indexDefinition.method === 'gin';\n\n        const skip = isComplex && this.columns.disableComplexTypes === true;\n\n        if (!skip) {\n          table.addIndex(indexDefinition);\n        }\n      }\n    }\n  }\n\n  viewColumnName(view, table, column) {\n    let name = null;\n\n    if (column.system) {\n      if (table.type === 'form') {\n        if (view.variant === 'full') {\n          name = this.columns.systemFormFullViewColumns[column.name];\n        } else {\n          name = this.columns.systemFormViewColumns[column.name];\n        }\n      } else if (table.type === 'repeatable') {\n        if (view.variant === 'full') {\n          name = this.columns.systemRepeatableFullViewColumns[column.name];\n        } else {\n          name = this.columns.systemRepeatableViewColumns[column.name];\n        }\n      } else if (table.type === 'values') {\n        name = this.columns.systemValuesViewColumns[column.name];\n      }\n\n      if (name == null) {\n        return null;\n      }\n\n      name = '_' + name;\n    } else if (column.element) {\n      name = this.escapeDataName(column.element.data_name) + (column.suffix || '');\n    } else {\n      name = column.name + (column.suffix || '');\n    }\n\n    if (name) {\n      // dedupe any columns\n      name = this.launderViewColumnName(view, column, name);\n    }\n\n    return name;\n  }\n\n  launderViewColumnName(view, column, name) {\n    const views = this.viewColumns;\n\n    views[view.name] = views[view.name] || {};\n\n    let count = 1;\n\n    const rawName = name.substring(0, 63).toLowerCase();\n    let newName = rawName;\n\n    while (views[view.name][newName]) {\n      newName = rawName.substring(0, 63 - (count.toString().length)) + count;\n      count++;\n    }\n\n    views[view.name][newName] = column;\n\n    return newName;\n  }\n\n  processElement(element, elementTable) {\n    switch (element.type) {\n      case 'TextField':\n        if (element.numeric) {\n          this.addDoubleElement(elementTable, element);\n        } else {\n          this.addStringElement(elementTable, element);\n        }\n        break;\n\n      case 'ChoiceField':\n        if (element.multiple) {\n          this.addArrayElement(elementTable, element);\n        } else {\n          this.addStringElement(elementTable, element);\n        }\n        break;\n\n      case 'ClassificationField':\n        this.addArrayElement(elementTable, element);\n        break;\n\n      case 'YesNoField':\n        this.addStringElement(elementTable, element);\n        break;\n\n      case 'PhotoField':\n      case 'VideoField':\n      case 'AudioField':\n      case 'AttachmentField':\n        this.addMediaElement(elementTable, element);\n        break;\n\n      case 'SignatureField':\n        this.addStringElement(elementTable, element);\n        this.addTimestampElement(elementTable, element, 'timestamp');\n        break;\n\n      case 'BarcodeField':\n        this.addStringElement(elementTable, element);\n        break;\n\n      case 'DateTimeField':\n      case 'DateField':\n        this.addDateElement(elementTable, element);\n        break;\n\n      case 'TimeField':\n        this.addTimeElement(elementTable, element);\n        break;\n\n      case 'Repeatable':\n        this.addRepeatableElement(elementTable, element);\n        break;\n\n      case 'AddressField':\n        this.addStringElement(elementTable, element);\n        this.addStringElement(elementTable, element, 'sub_thoroughfare');\n        this.addStringElement(elementTable, element, 'thoroughfare');\n        this.addStringElement(elementTable, element, 'suite');\n        this.addStringElement(elementTable, element, 'locality');\n        this.addStringElement(elementTable, element, 'admin_area');\n        this.addStringElement(elementTable, element, 'postal_code');\n        this.addStringElement(elementTable, element, 'sub_admin_area');\n        this.addStringElement(elementTable, element, 'country');\n        break;\n\n      case 'HyperlinkField':\n        this.addStringElement(elementTable, element);\n        break;\n\n      case 'RecordLinkField':\n        this.addRecordLinkElement(elementTable, element);\n        break;\n\n      case 'CalculatedField':\n        switch (element.display.style) {\n          case 'date':\n            if (this.columns.calculatedFieldDateFormat === 'date') {\n              this.addDateElement(elementTable, element);\n            } else {\n              this.addDoubleElement(elementTable, element);\n            }\n            break;\n          case 'number':\n          case 'currency':\n            this.addDoubleElement(elementTable, element);\n            break;\n          default:\n            this.addStringElement(elementTable, element);\n            break;\n        }\n        break;\n\n      case 'CheckboxField':\n        this.addBooleanElement(elementTable, element);\n        break;\n\n      case 'DynamicField':\n        this.addArrayElement(elementTable, element, 'metadata');\n        this.addArrayElement(elementTable, element, 'elements');\n        this.addArrayElement(elementTable, element, 'values');\n        break;\n\n      case 'LocationField':\n        this.addDoubleElement(elementTable, element, 'latitude');\n        this.addDoubleElement(elementTable, element, 'longitude');\n        this.addStringElement(elementTable, element, 'address');\n        break;\n\n      case 'ButtonField':\n        break;\n\n      default:\n        console.log('Unhandled element type', element.type);\n        break;\n    }\n  }\n\n  addStringColumn(table, name, suffix) {\n    if (suffix == null) {\n      suffix = '';\n    }\n    return this.addColumn(table, name, 'string', suffix);\n  }\n\n  addStringElement(table, element, suffix) {\n    if (suffix == null) {\n      suffix = '';\n    }\n    return this.addElement(table, element, 'string', suffix);\n  }\n\n  addDateElement(table, element, suffix) {\n    if (suffix == null) {\n      suffix = '';\n    }\n    return this.addElement(table, element, 'date', suffix);\n  }\n\n  addTimeElement(table, element, suffix) {\n    if (suffix == null) {\n      suffix = '';\n    }\n    return this.addElement(table, element, 'time', suffix);\n  }\n\n  addTimestampElement(table, element, suffix) {\n    if (suffix == null) {\n      suffix = '';\n    }\n    return this.addElement(table, element, 'timestamp', suffix);\n  }\n\n  addDoubleElement(table, element, suffix) {\n    if (suffix == null) {\n      suffix = '';\n    }\n    return this.addElement(table, element, 'double', suffix);\n  }\n\n  addBooleanElement(table, element, suffix) {\n    if (suffix == null) {\n      suffix = '';\n    }\n    return this.addElement(table, element, 'boolean', suffix);\n  }\n\n  addIntegerElement(table, element, suffix) {\n    if (suffix == null) {\n      suffix = '';\n    }\n    return this.addElement(table, element, 'integer', suffix);\n  }\n\n  addArrayElement(table, element, suffix) {\n    if (suffix == null) {\n      suffix = '';\n    }\n\n    const dataType = this.columns.disableArrays === true ? 'string' : 'array';\n\n    return this.addElement(table, element, dataType, suffix);\n  }\n\n  addColumn(table, name, type, suffix) {\n    let column = null;\n\n    if (suffix == null) {\n      suffix = '';\n    }\n\n    if (suffix) {\n      suffix = '_' + suffix;\n    }\n\n    column = {\n      id: name + suffix,\n      type: this.maybeComplexType(type),\n      element: null,\n      suffix: suffix\n    };\n\n    table.addColumn(column);\n  }\n\n  addElement(table, element, type, suffix) {\n    let column = null;\n\n    if (suffix == null) {\n      suffix = '';\n    }\n\n    if (suffix) {\n      suffix = '_' + suffix;\n    }\n\n    column = {\n      id: this.prefix + element.key + suffix,\n      type: this.maybeComplexType(type),\n      element: element,\n      suffix: suffix\n    };\n\n    table.addColumn(column);\n  }\n\n  maybeComplexType(type) {\n    const isComplex = SIMPLE_TYPES.indexOf(type) === -1;\n\n    return isComplex && this.columns.disableComplexTypes === true ? 'string' : type;\n  }\n\n  addMediaElement(table, element) {\n    this.addArrayElement(table, element);\n\n    if (element.type !== 'AttachmentField') {\n      if (this.columns.includeMediaCaptions !== false) {\n        this.addArrayElement(table, element, 'captions');\n      }\n\n      if (this.columns.includeMediaURLs) {\n        this.addArrayElement(table, element, 'urls');\n      }\n\n      if (this.columns.includeMediaViewURLs) {\n        this.addStringElement(table, element, 'view_url');\n      }\n    }\n\n    if (element.type === 'AttachmentField') {\n      this.addArrayElement(table, element, 'names');\n    }\n\n    if (!this.columns.systemFormViewColumns) {\n      return;\n    }\n\n    const value = element.key.replace(/'/g, \"''\");\n\n    const clause = format('WHERE key = \\'%s\\'', value);\n\n    const filter = {\n      key: value\n    };\n\n    const alias = {\n      PhotoField: '_photo_id',\n      VideoField: '_video_id',\n      AudioField: '_audio_id',\n      AttachmentField: '_attachment_id'\n    }[element.type];\n\n    if (alias) {\n      const view = new View(this.formTable.id + '_' + element.key + '_view',\n                            null, this.valuesTable, {type: 'media', element: element, clause: clause, filter, alias: this.alias(element.data_name)});\n\n      view.addColumn({column: {name: 'record_resource_id', type: 'string'}, alias: 'record_id'});\n      view.addColumn({column: {name: 'parent_resource_id', type: 'string'}, alias: 'parent_id'});\n      view.addColumn({column: {name: 'text_value', type: 'string'}, alias: alias});\n\n      this.views.push(view);\n    }\n  }\n\n  addRecordLinkElement(parentTable, element) {\n    this.addArrayElement(parentTable, element);\n\n    if (!this.columns.systemFormViewColumns) {\n      return;\n    }\n\n    const value = element.key.replace(/'/g, \"''\");\n\n    const clause = format('WHERE key = \\'%s\\'', value);\n\n    const view = new View(this.formTable.id + '_' + element.key + '_view',\n                          null, this.valuesTable, {type: 'link', element: element, clause: clause, alias: this.alias(element.data_name)});\n\n    view.addColumn({column: {name: 'record_resource_id', type: 'string'}, alias: 'source_record_id'});\n    view.addColumn({column: {name: 'parent_resource_id', type: 'string'}, alias: 'parent_id'});\n    view.addColumn({column: {name: 'text_value', type: 'string'}, alias: 'linked_record_id'});\n\n    this.views.push(view);\n  }\n\n  addRepeatableElement(parentTable, element) {\n    const childTable = this.buildRepeatableTable(parentTable, element);\n\n    this.tables.push(childTable);\n\n    const elements = Utils.flattenElements(element.elements, false);\n\n    const childElements = DataElements.find(elements);\n\n    for (const childElement of childElements) {\n      this.processElement(childElement, childTable);\n    }\n  }\n}\n"],"mappings":"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"}